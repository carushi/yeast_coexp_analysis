#!/bin/bash
set -euxo pipefail 

for rep in $( seq 1 2 );
do
if [ "$rep" -eq "1" ]; then
CASES=(E19ab104232_S19 E20ab104232_S20 E21ab104232_S21 E21-A0_S19 E24-A45_S22 E27-A90_S22 E22-B0_S20 E25-B45_S23 E28-B90_S23 E23-C0_S21 E26-C45_S24 E29-C90_S24)
CONTROLS=(INP1_S22 INP2_S23 INP3_S24 INP21-A0_S16 INP24-A45_S19 INP27-A90_S22 INP22-B0_S17 INP25-B45_S20 INP28-B90_S23 INP23-C0_S18 INP26-C45_S21 INP29-C90_S24)
else
CASES=(E121-A0-ab104232_S10 E124-A45-ab104232_S13 E127-A90-ab104232_S1 E122-B0-ab104232_S11 E125-B45-ab104232_S23 E128-B90-ab104232_S2 E123-C0-ab104232_S12 E126-C45-ab104232_S24 E129-C90-ab104232_S3)
CONTROLS=(INP-101-A0_S4 INP-104-A45_S13 INP-107-A90_S16 INP-102-B0_S11 INP-105-B45_S14 INP-108-B90_S17 INP-103-C0_S12 INP-106-C45_S15 INP-109-C90_S18)
fi
SORT_FLAG=".sorted"
REG_FLAG="_valid"
TAIL=__trimmed_R1${SORT_FLAG}${REG_FLAG}.bam
echo $CASES
for i in $( seq 0 11 );
do
if [ "$rep" -eq "1" && "$i" -lt 3 ]; then
continue
fi
echo $i
CASE=${CASES[$i]}
CONTROL=${CONTROLS[$i]}
ls $CASE$TAIL
ls $CONTROL$TAIL
MIN_M=3
macs2 callpeak -f BAMPE -t $CASE$TAIL -c $CONTROL$TAIL -g 1.21e7 -n peak_pe_${i}_${rep}${REG_FLAG} -B -q 0.01 -m $MIN_M 50
macs2 callpeak -f BAMPE -t $CASE$TAIL -c $CONTROL$TAIL -g 1.21e7 -n peak_pe_${i}_${rep}_broad${REG_FLAG} --broad --broad-cutoff 0.1 -m $MIN_M 50

done
done
